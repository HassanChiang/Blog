---

title: Netty 笔记汇总
date: 2020-05-24
description:
{: id="20201220214147-f2cb6ew"}

tags:
{: id="20201220214147-0nn5qxt"}

- {: id="20201220214147-my148p4"}Java
- {: id="20201220214147-qec5ucw"}Netty
- {: id="20201220214147-9sbtqw6"}笔记
{: id="20201220214147-2dhy68k"}

nav:
{: id="20201220214147-i88u2kn"}

- {: id="20201220214147-874a82o"}Java 框架
{: id="20201220214147-7l5v2v1"}

categories:
{: id="20201220214147-ig5lfj0"}

- {: id="20201220214147-ufgbvf7"}Netty
{: id="20201220214147-fsmo4pl"}

image: images/java/netty-logo.png
{: id="20201220214147-t7de3be"}

---

# netty概要
{: id="20201220214147-9v17prb"}

netty是一个异步非阻塞的通信框架（类似的框架还有mina，grizzly）。
{: id="20201220214147-p4xx37t"}

底层封装了NIO2.0模块，即AIO。
{: id="20201220214147-03ngj4e"}

好处：使用起来无需关注如何连接，只需关注业务逻辑处理代码，而且性能高效。遵循servlet3.0标准规范的，和tomcat等web容器不同的是异步非阻塞。tomcat容器支持最大并发量大概在800左右。而且netty也不算是web容器。
{: id="20201220214147-ubi9gl1"}

使用流程：
服务端：配置端口，长连接还是短连接（针对业务，比如聊天一般用长连接，和客户端保持连接，短连接是针对是数据量大连接次数少的情况，比如一小时上传文件4到5次），最后要调用下异步关闭，否则服务端会关闭的，一般我们是不允许服务端关闭的。
{: id="20201220214147-9ecszzl"}

应用场景：作为路由网关、文件上传和下载，消息通信，心跳检测等。
{: id="20201220214147-47nn7nr"}

拆包粘包问题：设置定长（一次只能传输200K以下的数据，小于200k的后面以空格补全）、设置特殊分割符（编解码）、自定义协议（实现编解码的接口，进行扩展而已）。
{: id="20201220214147-rxuryhe"}

编解码（序列化）：传输数据如果为对象，实体类必须要实现serialable接口，但java序列化码流大，传输慢，性能低。可以使用joss框架Marshalling+压缩解压缩这样的方式实现。
{: id="20201220214147-gtx5dxq"}

业务问题：
{: id="20201220214147-xaruad9"}

1. {: id="20201220214147-wlmi7r1"}若客户端和服务端为短连接，规定时间内（比如5秒）不传输数据默认断开，如何实现？
   调用readTimeoutHandler(5)。
2. {: id="20201220214147-b0kmq13"}若客户端和服务端断开连接后，客户端再次发送请求，如何才能保证服务端接收到数据？
   在客户端初始化的时候，判断下客户端是否服务端保持连接，如果没有，重新连接下。
{: id="20201220214147-zydk4do"}

摘自：https://github.com/ouzhrm/netty_study/blob/master/README.md
{: id="20201220214147-1pn07dv"}

# 组件
{: id="20201220214147-bpode1d"}

![](./2020-05-24_Netty%20笔记汇总/1.png)
{: id="20201220214147-4xjfaou"}

## ByteBuf
{: id="20201220214147-vsdsegr"}

## Channel 和 Unsafe
{: id="20201220214147-ku6d882"}

### OioServerSocketChannel 和 OioSocketChannel
{: id="20201220214147-akpjh1e"}

### NioServerSocketChannel 和 NioSocketChannel
{: id="20201220214147-346pr6h"}

## ChannelPipeline 和 ChannelHandler
{: id="20201220214147-h3h61zc"}

## Future 和 Promise
{: id="20201220214147-xe0hysr"}

## EventLoop 和 EventLoopGroup
{: id="20201220214147-6hqp8ew"}

## ServerBootstrap 和 Bootstrap
{: id="20201220214147-7nzwzbk"}

启动类
{: id="20201220214147-ddgpoj3"}

## Encode 和 Decoder
{: id="20201220214147-v5vfhqj"}

协议～
{: id="20201220214147-e9ygaol"}


{: id="20201220214147-1qrsxqe" type="doc"}
