---

title: 高性能 MySQL 阅读笔记 (1)
date: 2020-09-09
description:
{: id="20201220214147-hykshgo"}

tags:
{: id="20201220214147-aqdwhtb"}

- {: id="20201220214147-av3cr7c"}MySQL
- {: id="20201220214147-0ibndfd"}性能优化
- {: id="20201220214147-vgzi339"}阅读笔记
{: id="20201220214147-arlvsvn"}

nav:
{: id="20201220214147-ee5l21k"}

- {: id="20201220214147-gi5z69a"}数据库
{: id="20201220214147-duannq1"}

categories:
{: id="20201220214147-8cuqhxl"}

- {: id="20201220214147-jeaboqk"}MySQL
{: id="20201220214147-vht0o84"}

image: images/MySQL.png
{: id="20201220214147-y5c3uw2"}

---

# 概述
{: id="20201220214147-uv0jpb2"}

### 什么是性能？
{: id="20201220214147-z1mt07y"}

完成某件任务所需要的时间度量，也就是响应时间。
{: id="20201220214147-g8czhu2"}

### 什么是优化？
{: id="20201220214147-em5u8oo"}

在一定的工作负载下，尽可能地降低响应时间。
{: id="20201220214147-796itx8"}

核心：找到时间花在哪里，这很重要。
{: id="20201220214147-96qqald"}

### 如何找？
{: id="20201220214147-oc7gox6"}

通过测量，所以测量是性能优化的关键方法。
{: id="20201220214147-fxw9qui"}

### 如何测量？
{: id="20201220214147-uvdsr8d"}

找到系统的可测量点，但首先需要系统可测量化的支持，然而实际情况是系统很少可以做到可测量化。
{: id="20201220214147-5iyxb3o"}

因为很难进行系统内部测量，所以我们只能尽可能通过外部去测量系统。
{: id="20201220214147-lgurztz"}

另外需要注意是的，无论是内部测量还是外部测量，数据都不一定是百分之百准确的。
{: id="20201220214147-lgwiceu"}

举例：如果`SQL`慢查了，花费了10s，如果9.6s都在等待磁盘IO，那么追究其他的0.4s就没什么意义。
{: id="20201220214147-pdcwnng"}

# 理解性能优剖析
{: id="20201220214147-kw24m23"}

### 什么是值得优化的查询
{: id="20201220214147-xxaxyni"}

```
1. 占系统总体性能影响比重大的；
2. 投入成本低于优化后的收入；
```
{: id="20201220214147-i455qvc"}

### 异常情况
{: id="20201220214147-c7ml9sb"}

系统内部的异常
{: id="20201220214147-xczwe4k"}

### 未知的未知
{: id="20201220214147-vueeyn0"}

性能优化过程发现了“丢失的时间”，比如：程序内部测量点发现耗时10s，但`MySQL`内部测量发现耗时是8s，那么丢失的2s可能就是没有测量到的，需要注意。
{: id="20201220214147-k5p15cj"}

### 注意平均值问题
{: id="20201220214147-hivxocr"}

平均值往往掩盖一些频率小但有性能问题的点
{: id="20201220214147-gku0f3e"}

# 对应用程序剖析
{: id="20201220214147-ctgigri"}

增加测量点本身一定程度上会增加部分开销，但这部分开销如果远小于性能优化的贡献。
轻量级监控：为了尽可能降低性能监控开销，可以增加灰度测量点，只针对n%的概率进行监控。
{: id="20201220214147-j3eq9mc"}

# 剖析MySQL
{: id="20201220214147-rs7xb7x"}

× 慢查日志
{: id="20201220214147-cakv533"}

× 剖析单条查询
{: id="20201220214147-0e6wnqo"}


{: id="20201220214147-5idfhcz" type="doc"}
